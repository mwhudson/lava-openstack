metadata:
   name: tempest
   maintainer:
      - Michael Hudson-Doyle <michael.hudson@linaro.org>
   format: "Lava-Test-Shell Test Definition 1.0"
   version: 1.0
   description: ""
   os:
      - ubuntu
   devices:
      - mustang
   environment:
      - lava-test-shell

run:
  steps:
    - "resolvconf -u"
    - "set -x"
    - "export LAVA_RUN_TEMPEST LAVA_TESTS_TO_RUN"
    - "sudo -u ubuntu -E ~/run-in-tempest-dir.sh ./tempest.sh"
    - "lava-test-run-attach output/all-tests.txt"
    - "lava-test-run-attach output/tempest.conf"
    - "lava-test-run-attach output/results.csv"
    - "python simplify-results.py output/results.csv output/all-tests.txt"
    - "set +x"


params:
  LAVA_RUN_TEMPEST: 'yes'
  LAVA_TESTS_TO_RUN: ''

parse:
  pattern: "TEST@(?P<test_case_id>[-0-9A-Za-z_.]+)@ RESULT@(?P<result>[-0-9A-Za-z_.]+)@"
